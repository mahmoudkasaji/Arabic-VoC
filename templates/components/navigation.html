<!-- Enhanced Navigation Component with 5-Tab Architecture -->
<nav class="navbar-custom">
    <div class="container-custom">
        <!-- Brand/Home -->
        <a class="navbar-brand-custom" href="/">
            <i class="fas fa-home me-2"></i>
            منصة صوت العميل العربية
        </a>
        
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="mainNavigation">
            <!-- Primary Navigation -->
            <ul class="navbar-nav me-auto">
                <!-- 1. Surveys -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="surveysDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-poll me-1"></i>
                        الاستطلاعات
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="/surveys/create">
                            <i class="fas fa-plus me-2"></i>إنشاء استطلاع جديد
                        </a></li>
                        <li><a class="dropdown-item" href="/surveys/manage">
                            <i class="fas fa-list me-2"></i>إدارة الاستطلاعات
                        </a></li>
                        <li><a class="dropdown-item" href="/surveys/responses">
                            <i class="fas fa-chart-bar me-2"></i>الردود والنتائج
                        </a></li>
                    </ul>
                </li>

                <!-- 2. Dashboards -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="dashboardsDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-tachometer-alt me-1"></i>
                        لوحات القيادة
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="/dashboards/executive">
                            <i class="fas fa-crown me-2"></i>العرض التنفيذي
                        </a></li>
                        <li><a class="dropdown-item" href="/dashboards/analyst">
                            <i class="fas fa-chart-line me-2"></i>عرض المحلل
                        </a></li>
                    </ul>
                </li>

                <!-- 3. Integrations -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="integrationsDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-plug me-1"></i>
                        التكاملات
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="/integrations/sources">
                            <i class="fas fa-download me-2"></i>مصادر البيانات
                        </a></li>
                        <li><a class="dropdown-item" href="/integrations/destinations">
                            <i class="fas fa-upload me-2"></i>وجهات البيانات
                        </a></li>
                    </ul>
                </li>

                <!-- 4. Analytics -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="analyticsDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-brain me-1"></i>
                        التحليلات
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="/analytics/insights">
                            <i class="fas fa-lightbulb me-2"></i>الرؤى المباشرة
                        </a></li>
                        <li><a class="dropdown-item" href="/analytics/reports">
                            <i class="fas fa-file-export me-2"></i>التقارير والتصدير
                        </a></li>
                        <li><a class="dropdown-item" href="/analytics/ai-lab">
                            <i class="fas fa-flask me-2"></i>مختبر الذكاء الاصطناعي
                        </a></li>
                    </ul>
                </li>

                <!-- 5. Settings -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="settingsDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-cog me-1"></i>
                        الإعدادات
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="/settings/users">
                            <i class="fas fa-users me-2"></i>إدارة المستخدمين
                        </a></li>
                        <li><a class="dropdown-item" href="/settings/system">
                            <i class="fas fa-sliders-h me-2"></i>إعدادات النظام
                        </a></li>
                    </ul>
                </li>
            </ul>

            <!-- User Menu -->
            <ul class="navbar-nav">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-user-circle me-1"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="/login">
                            <i class="fas fa-sign-in-alt me-2"></i>تسجيل الدخول
                        </a></li>
                        <li><a class="dropdown-item" href="/register">
                            <i class="fas fa-user-plus me-2"></i>إنشاء حساب
                        </a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>
                            <i class="fas fa-comment me-2"></i>جمع التعليقات
                        </a></li>
                        <li><a class="dropdown-item" href="/surveys/responses">
                            <i class="fas fa-inbox me-2"></i>إدارة الردود
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li class="dropdown-header">التوزيع متعدد القنوات</li>
                        <li><a class="dropdown-item" href="/surveys/distribution-demo" style="background-color: #e8f5e8; font-weight: bold;">
                            <i class="fas fa-paper-plane me-2 text-success"></i>نظام التوزيع الجديد ⭐
                        </a></li>
                    </ul>
                </li>
                
                <!-- 2. Analytics -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="analyticsDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-chart-line me-1"></i>
                        التحليلات
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li class="dropdown-header">لوحات المعلومات</li>
                        <li><a class="dropdown-item" href="/analytics/executive">
                            <i class="fas fa-tachometer-alt me-2"></i>لوحة القيادة
                        </a></li>
                        <li><a class="dropdown-item" href="/analytics/detailed">
                            <i class="fas fa-chart-bar me-2"></i>التحليلات التفصيلية
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li class="dropdown-header">رؤى متخصصة</li>
                        <li><a class="dropdown-item" href="/analytics/arabic">
                            <i class="fas fa-language me-2"></i>الرؤى العربية
                        </a></li>
                        <li><a class="dropdown-item" href="/analytics/reports">
                            <i class="fas fa-file-alt me-2"></i>التقارير والتصدير
                        </a></li>
                    </ul>
                </li>
                
                <!-- 3. Integrations -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="integrationsDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-plug me-1"></i>
                        التكاملات
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li class="dropdown-header">تدفق البيانات</li>
                        <li><a class="dropdown-item" href="/integrations/sources">
                            <i class="fas fa-download text-success me-2"></i>مصادر البيانات
                        </a></li>
                        <li><a class="dropdown-item" href="/integrations/destinations">
                            <i class="fas fa-upload text-primary me-2"></i>وجهات البيانات
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li class="dropdown-header">الذكاء الاصطناعي</li>
                        <li><a class="dropdown-item" href="/integrations/ai">
                            <i class="fas fa-brain text-purple me-2"></i>إدارة الذكاء الاصطناعي
                        </a></li>
                    </ul>
                </li>
                
                <!-- 4. Settings -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="settingsDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-cog me-1"></i>
                        الإعدادات
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li class="dropdown-header">إدارة الحساب</li>
                        <li><a class="dropdown-item" href="/settings/account">
                            <i class="fas fa-user me-2"></i>إدارة الحساب
                        </a></li>
                        <li><a class="dropdown-item" href="/settings/system">
                            <i class="fas fa-sliders-h me-2"></i>إعدادات النظام
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li class="dropdown-header">الأمان والإدارة</li>
                        <li><a class="dropdown-item" href="/settings/security">
                            <i class="fas fa-shield-alt me-2"></i>الأمان والخصوصية
                        </a></li>
                        <li><a class="dropdown-item" href="/settings/admin">
                            <i class="fas fa-server me-2"></i>إدارة المنصة
                        </a></li>
                    </ul>
                </li>
            </ul>
            
            <!-- User Actions -->
            <ul class="navbar-nav">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-user-circle me-1"></i>
                        المستخدم
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="/profile">
                            <i class="fas fa-user me-2"></i>الملف الشخصي
                        </a></li>
                        <li><a class="dropdown-item" href="/help">
                            <i class="fas fa-question-circle me-2"></i>المساعدة
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="/logout">
                            <i class="fas fa-sign-out-alt me-2"></i>تسجيل الخروج
                        </a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Breadcrumb Component -->
<nav aria-label="breadcrumb" class="breadcrumb-nav">
    <div class="container-fluid">
        <ol class="breadcrumb" id="dynamicBreadcrumb">
            <li class="breadcrumb-item">
                <a href="/"><i class="fas fa-home me-1"></i>الرئيسية</a>
            </li>
            <!-- Dynamic breadcrumb items will be inserted here -->
        </ol>
    </div>
</nav>

<style>
    .navbar-main {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid #e9ecef;
        padding: 1rem 0;
        box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    }

    .navbar-brand {
        font-weight: 700;
        color: var(--primary-color) !important;
        font-size: 1.5rem;
        transition: color 0.3s ease;
    }

    .navbar-brand:hover {
        color: var(--primary-color) !important;
        opacity: 0.8;
    }

    .nav-link {
        color: var(--text-color) !important;
        font-weight: 500;
        padding: 0.75rem 1rem !important;
        border-radius: 8px;
        margin: 0 0.25rem;
        transition: all 0.3s ease;
    }

    .nav-link:hover, .nav-link.active {
        background: var(--primary-color);
        color: white !important;
    }

    .dropdown-menu {
        border: none;
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        border-radius: 12px;
        padding: 0.5rem 0;
        min-width: 250px;
    }

    .dropdown-header {
        color: var(--primary-color);
        font-weight: 600;
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        padding: 0.5rem 1rem 0.25rem;
    }

    .dropdown-item {
        padding: 0.75rem 1rem;
        color: var(--text-color);
        transition: all 0.3s ease;
    }

    .dropdown-item:hover {
        background: rgba(46, 139, 87, 0.1);
        color: var(--primary-color);
    }

    .dropdown-item i {
        width: 20px;
        text-align: center;
    }

    .breadcrumb-nav {
        background: #f8f9fa;
        padding: 0.5rem 0;
        border-bottom: 1px solid #e9ecef;
    }

    .breadcrumb {
        margin-bottom: 0;
        background: transparent;
        font-size: 0.9rem;
    }

    .breadcrumb-item a {
        color: var(--primary-color);
        text-decoration: none;
        transition: color 0.3s ease;
    }

    .breadcrumb-item a:hover {
        color: var(--text-color);
    }

    .breadcrumb-item.active {
        color: var(--text-color);
        font-weight: 500;
    }

    /* Mobile responsive */
    @media (max-width: 768px) {
        .navbar-brand {
            font-size: 1.2rem;
        }
        
        .dropdown-menu {
            min-width: 200px;
        }
        
        .breadcrumb {
            font-size: 0.8rem;
        }
    }

    /* RTL specific adjustments */
    .dropdown-menu-end {
        right: 0;
        left: auto;
    }

    [dir="rtl"] .dropdown-menu-end {
        right: auto;
        left: 0;
    }
</style>

<script>
    // Dynamic breadcrumb management
    class BreadcrumbManager {
        constructor() {
            this.breadcrumbContainer = document.getElementById('dynamicBreadcrumb');
            this.updateBreadcrumb();
        }

        updateBreadcrumb() {
            const path = window.location.pathname;
            const breadcrumbs = this.generateBreadcrumbs(path);
            this.renderBreadcrumbs(breadcrumbs);
        }

        generateBreadcrumbs(path) {
            const pathMap = {
                '/surveys/builder': ['الاستطلاعات', 'منشئ الاستطلاعات'],
                '/surveys/manage': ['الاستطلاعات', 'إدارة الاستطلاعات'],
                '/surveys/feedback': ['الاستطلاعات', 'جمع التعليقات'],
                '/surveys/responses': ['الاستطلاعات', 'إدارة الردود'],
                '/analytics/executive': ['التحليلات', 'لوحة القيادة'],
                '/analytics/detailed': ['التحليلات', 'التحليلات التفصيلية'],
                '/analytics/arabic': ['التحليلات', 'الرؤى العربية'],
                '/analytics/reports': ['التحليلات', 'التقارير والتصدير'],
                '/integrations/sources': ['التكاملات', 'مصادر البيانات'],
                '/integrations/destinations': ['التكاملات', 'وجهات البيانات'],
                '/integrations/ai': ['التكاملات', 'إدارة الذكاء الاصطناعي'],
                '/settings/account': ['الإعدادات', 'إدارة الحساب'],
                '/settings/system': ['الإعدادات', 'إعدادات النظام'],
                '/settings/security': ['الإعدادات', 'الأمان والخصوصية'],
                '/settings/admin': ['الإعدادات', 'إدارة المنصة']
            };

            return pathMap[path] || [];
        }

        renderBreadcrumbs(items) {
            if (!this.breadcrumbContainer) return;
            
            // Keep home breadcrumb
            const homeCrumb = this.breadcrumbContainer.querySelector('li:first-child');
            this.breadcrumbContainer.innerHTML = '';
            if (homeCrumb) {
                this.breadcrumbContainer.appendChild(homeCrumb);
            }

            // Add dynamic breadcrumbs
            items.forEach((item, index) => {
                const li = document.createElement('li');
                li.className = index === items.length - 1 ? 'breadcrumb-item active' : 'breadcrumb-item';
                
                if (index === items.length - 1) {
                    li.textContent = item;
                } else {
                    const a = document.createElement('a');
                    a.href = 'javascript:void(0)';
                    a.textContent = item;
                    li.appendChild(a);
                }
                
                this.breadcrumbContainer.appendChild(li);
            });
        }
    }

    // Initialize breadcrumb manager
    document.addEventListener('DOMContentLoaded', () => {
        new BreadcrumbManager();
    });

    // Update active navigation state
    function updateActiveNavigation() {
        const currentPath = window.location.pathname;
        document.querySelectorAll('.nav-link').forEach(link => {
            link.classList.remove('active');
            
            // Check if current path matches dropdown item
            const href = link.getAttribute('href');
            if (href && currentPath.startsWith(href)) {
                link.classList.add('active');
                
                // Also highlight parent dropdown
                const dropdown = link.closest('.dropdown');
                if (dropdown) {
                    dropdown.querySelector('.dropdown-toggle').classList.add('active');
                }
            }
        });
    }

    document.addEventListener('DOMContentLoaded', updateActiveNavigation);
</script>