<!-- Voice of Customer Platform - Unified Centered Navigation -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
    <div class="container">
        <!-- Brand - Centered Layout -->
        <a class="navbar-brand fw-bold text-primary mx-auto mx-lg-0" href="/" style="font-size: 1.25rem;">
            <i class="fas fa-home me-2"></i>
            {{ 'app.name' | translate }}
        </a>
        
        <!-- Language Toggle Button -->
        <div class="navbar-nav ms-auto me-3">
            <button class="btn btn-outline-primary btn-sm" onclick="toggleLanguage()" title="{{ 'language.toggle_tooltip' | translate }}">
                <i class="fas fa-globe me-1"></i>
                {{ 'language.switch_to' | translate }}
            </button>
        </div>
        
        <!-- Mobile Toggle -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavigation" 
                aria-controls="mainNavigation" aria-expanded="false" aria-label="{{ 'navigation.toggle_menu' | translate }}">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <!-- Main Navigation - Centered -->
        <div class="collapse navbar-collapse justify-content-center" id="mainNavigation">
            <ul class="navbar-nav mb-2 mb-lg-0">
                <!-- 1. Surveys -->
                <li class="nav-item dropdown mx-2">
                    <a class="nav-link dropdown-toggle" href="#" id="surveysDropdown" role="button" 
                       data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-poll me-1"></i>{{ 'navigation.surveys_dropdown.title' | translate }}
                    </a>
                    <ul class="dropdown-menu">
                        <li><h6 class="dropdown-header">{{ 'navigation.surveys_dropdown.integrated_workflow' | translate }}</h6></li>
                        <li><a class="dropdown-item" href="/surveys/create">
                            <i class="fas fa-plus me-2"></i>{{ 'navigation.surveys_dropdown.create_new' | translate }}
                        </a></li>
                        <li><a class="dropdown-item" href="/surveys">
                            <i class="fas fa-tasks me-2 text-primary"></i>{{ 'navigation.surveys_dropdown.management_center' | translate }} ⭐
                            <small class="d-block text-muted">{{ 'navigation.surveys_dropdown.management_subtitle' | translate }}</small>
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><h6 class="dropdown-header">{{ 'navigation.surveys_dropdown.analytics_reports' | translate }}</h6></li>
                        <li><a class="dropdown-item" href="/surveys/responses">
                            <i class="fas fa-chart-bar me-2"></i>{{ 'navigation.surveys_dropdown.responses_results' | translate }}
                        </a></li>
                    </ul>
                </li>
                
                <!-- 2. Contacts -->
                <li class="nav-item dropdown mx-2">
                    <a class="nav-link dropdown-toggle" href="#" id="contactsDropdown" role="button" 
                       data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-address-book me-1"></i>جهات الاتصال
                    </a>
                    <ul class="dropdown-menu">
                        <li><h6 class="dropdown-header">إدارة جهات الاتصال</h6></li>
                        <li><a class="dropdown-item" href="/contacts">
                            <i class="fas fa-users me-2 text-primary"></i>قائمة جهات الاتصال ⭐
                            <small class="d-block text-muted">إدارة وتنظيم جهات الاتصال</small>
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><h6 class="dropdown-header">أدوات التوزيع</h6></li>
                        <li><a class="dropdown-item" href="/contacts?action=test-email">
                            <i class="fas fa-envelope-open me-2"></i>اختبار البريد الإلكتروني
                        </a></li>
                        <li><a class="dropdown-item" href="/contacts?action=bulk-import">
                            <i class="fas fa-upload me-2"></i>استيراد جماعي
                        </a></li>
                    </ul>
                </li>
                
                <!-- 3. Analytics (Consolidated Dashboard + Analytics) -->
                <li class="nav-item dropdown mx-2">
                    <a class="nav-link dropdown-toggle" href="#" id="analyticsDropdown" role="button" 
                       data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-chart-line me-1"></i>{{ 'navigation.analytics_dropdown.title' | translate }}
                    </a>
                    <ul class="dropdown-menu">
                        <li><h6 class="dropdown-header">{{ 'navigation.analytics_dropdown.dashboards' | translate }}</h6></li>
                        <li><a class="dropdown-item" href="/analytics/dashboard">
                            <i class="fas fa-tachometer-alt me-2"></i>{{ 'navigation.analytics_dropdown.executive_dashboard' | translate }}
                        </a></li>
                        <li><a class="dropdown-item" href="/analytics/insights">
                            <i class="fas fa-lightbulb me-2"></i>{{ 'navigation.analytics_dropdown.smart_insights' | translate }}
                        </a></li>
                        <li><a class="dropdown-item" href="/analytics/demo">
                            <i class="fas fa-play me-2 text-success"></i>{{ 'navigation.analytics_dropdown.live_demo' | translate }} ⭐
                        </a></li>
                        <li><a class="dropdown-item" href="/analytics/enhanced-test">
                            <i class="fas fa-microscope me-2 text-warning"></i>اختبار التحليلات المحسنة
                            <small class="d-block text-muted">المرحلة 3أ - كشف المشاعر والمواضيع</small>
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><h6 class="dropdown-header">{{ 'navigation.analytics_dropdown.reports' | translate }}</h6></li>
                        <li><a class="dropdown-item" href="/analytics/reports">
                            <i class="fas fa-file-pdf me-2 text-success"></i>التقارير المهنية ⭐
                            <small class="d-block text-muted">المرحلة 3ب - تقارير PDF وتصدير البيانات</small>
                        </a></li>
                    </ul>
                </li>
                
                <!-- 4. Integrations -->
                <li class="nav-item dropdown mx-2">
                    <a class="nav-link dropdown-toggle" href="#" id="integrationsDropdown" role="button" 
                       data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-plug me-1"></i>{{ 'navigation.integrations_dropdown.title' | translate }}
                    </a>
                    <ul class="dropdown-menu">
                        <li><h6 class="dropdown-header">{{ 'navigation.integrations_dropdown.data_flow' | translate }}</h6></li>
                        <li><a class="dropdown-item" href="/integrations">
                            <i class="fas fa-brain me-2 text-purple"></i>{{ 'navigation.integrations_dropdown.ai_management' | translate }}
                        </a></li>
                    </ul>
                </li>
                
                <!-- 5. Settings -->
                <li class="nav-item dropdown mx-2">
                    <a class="nav-link dropdown-toggle" href="#" id="settingsDropdown" role="button" 
                       data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-cog me-1"></i>{{ 'navigation.settings_dropdown.title' | translate }}
                    </a>
                    <ul class="dropdown-menu">
                        <li><h6 class="dropdown-header">{{ 'navigation.settings_dropdown.system_management' | translate }}</h6></li>
                        <li><a class="dropdown-item" href="/settings">
                            <i class="fas fa-sliders-h me-2"></i>{{ 'navigation.settings_dropdown.system_management' | translate }}
                        </a></li>
                        <li><a class="dropdown-item" href="/settings/users">
                            <i class="fas fa-users me-2"></i>{{ 'navigation.settings_dropdown.user_management' | translate }}
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><h6 class="dropdown-header">{{ 'navigation.settings_dropdown.design_system' | translate }}</h6></li>
                        <li><a class="dropdown-item" href="/settings/design-system">
                            <i class="fas fa-palette me-2"></i>{{ 'navigation.settings_dropdown.design_system' | translate }}
                            <small class="d-block text-muted">{{ 'navigation.settings_dropdown.design_subtitle' | translate }}</small>
                        </a></li>
                    </ul>
                </li>
            </ul>
        </div>
        
        <!-- User Actions - Right Side -->
        <div class="d-none d-lg-flex">
            <ul class="navbar-nav">
                <li class="nav-item dropdown">
                    {% if current_user.is_authenticated %}
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" 
                           data-bs-toggle="dropdown" aria-expanded="false">
                            {% if current_user.profile_image_url %}
                                <img src="{{ current_user.profile_image_url }}" alt="Profile" 
                                     style="width: 24px; height: 24px; border-radius: 50%; object-fit: cover; margin-right: 8px;">
                            {% else %}
                                <i class="fas fa-user-circle me-1"></i>
                            {% endif %}
                            {{ current_user.first_name or 'User' }}
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="/profile">
                                <i class="fas fa-user me-2"></i>{{ 'navigation.profile' | translate }}
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="/auth/logout">
                                <i class="fas fa-sign-out-alt me-2"></i>{{ 'buttons.logout' | translate }}
                            </a></li>
                        </ul>
                    {% else %}
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" 
                           data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-user-circle me-1"></i>{{ 'auth.login.title' | translate }}
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="/auth/replit_auth">
                                <i class="fas fa-sign-in-alt me-2"></i>{{ 'buttons.login' | translate }}
                            </a></li>
                        </ul>
                    {% endif %}
                </li>
            </ul>
        </div>
    </div>
</nav>

<style>
/* Unified Navigation Styling */
.navbar {
    padding: 1rem 0;
    border-bottom: 1px solid #e9ecef;
}

.navbar-brand {
    font-weight: 700;
    color: var(--primary-500, #2E8B57) !important;
    transition: opacity 0.3s ease;
}

.navbar-brand:hover {
    opacity: 0.8;
}

.navbar-nav .nav-link {
    font-weight: 500;
    padding: 0.75rem 1rem;
    color: var(--text-primary, #2c3e50) !important;
    transition: all 0.3s ease;
    border-radius: 0.375rem;
    margin: 0 0.25rem;
}

.navbar-nav .nav-link:hover {
    background-color: var(--primary-50, #f0f9f4);
    color: var(--primary-600, #25754a) !important;
}

.dropdown-menu {
    border: none;
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    border-radius: 0.5rem;
    padding: 0.5rem 0;
    margin-top: 0.5rem;
    min-width: 250px;
}

.dropdown-header {
    padding: 0.5rem 1rem;
    font-weight: 600;
    color: var(--primary-600, #25754a);
    border-bottom: 1px solid #f1f3f4;
    margin-bottom: 0.25rem;
}

.dropdown-item {
    padding: 0.5rem 1rem;
    color: var(--text-primary, #2c3e50);
    border-radius: 0.25rem;
    margin: 0.125rem 0.5rem;
    transition: all 0.2s ease;
}

.dropdown-item:hover {
    background-color: var(--primary-50, #f0f9f4);
    color: var(--primary-600, #25754a);
}

.dropdown-item i {
    width: 20px;
    text-align: center;
}

.dropdown-divider {
    margin: 0.5rem 0;
}

/* Arabic RTL Support */
[dir="rtl"] .navbar-nav {
    flex-direction: row-reverse;
}

[dir="rtl"] .dropdown-menu {
    right: 0;
    left: auto;
}

/* Mobile Responsive */
@media (max-width: 991.98px) {
    .navbar-nav .nav-link {
        margin: 0;
        border-radius: 0;
    }
    
    .dropdown-menu {
        position: static !important;
        transform: none !important;
        box-shadow: none;
        border: 1px solid var(--border-light, #e9ecef);
        margin-top: 0;
    }
    
    .navbar-brand {
        order: 1;
    }
    
    .navbar-toggler {
        order: 2;
    }
    
    .navbar-collapse {
        order: 3;
        width: 100%;
    }
}

/* Centered Layout for Large Screens */
@media (min-width: 992px) {
    .navbar-nav {
        justify-content: center;
    }
    
    .justify-content-center {
        justify-content: center !important;
    }
}
</style>