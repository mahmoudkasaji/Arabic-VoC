<!-- Persistent Feedback Widget Component -->
<!-- Only show for authenticated users -->
{% if current_user.is_authenticated %}
<script src="/static/js/feedback-widget.js?v=2025072717"></script>
<script>
// Initialize feedback widget after page load
document.addEventListener('DOMContentLoaded', function() {
    console.log('üéØ Initializing feedback widget...');
    // Fetch widget configuration from simplified endpoint
    fetch('/feedback-widget/config')
        .then(response => response.json())
        .then(config => {
            console.log('üìã Widget config:', config);
            if (config.success && config.config.enabled) {
                // Initialize widget with user-specific configuration
                window.feedbackWidget = new FeedbackWidget({
                    position: config.config.position,
                    categories: config.config.categories,
                    currentLang: config.config.language
                });
                console.log('‚úÖ Feedback widget initialized with config');
            }
        })
        .catch(error => {
            console.log('‚ö†Ô∏è Feedback widget config failed, using defaults:', error);
            // Fallback to default initialization
            if (typeof FeedbackWidget !== 'undefined') {
                window.feedbackWidget = new FeedbackWidget();
                console.log('‚úÖ Feedback widget initialized with defaults');
            } else {
                console.error('‚ùå FeedbackWidget class not found');
            }
        });
});
</script>
{% endif %}