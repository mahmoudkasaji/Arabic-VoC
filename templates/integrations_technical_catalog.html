<!DOCTYPE html>
<html lang="{{ get_language_info().code }}" dir="{{ get_language_info().direction }}">
<head>
    {% include 'components/head.html' %}
    <title>{{ 'integrations_dropdown.ai_management' | translate }} - {{ 'app.name' | translate }}</title>
    
    <style>
    /* Unified AI & Technical Integrations Styling */
    .page-header-unified {
        background: linear-gradient(135deg, #1B5E20 0%, #2E7D32 100%);
        color: white;
        padding: 2rem 0;
        margin: -1.5rem -1.5rem 2rem -1.5rem;
        border-bottom: 3px solid #1B5E20;
    }
    
    /* Model/Integration Status Indicators */
    .model-status {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        display: inline-block;
        margin-left: 0.5rem;
    }
    
    .status-active { background: #28a745; }
    .status-inactive { background: #dc3545; }
    .status-warning { background: #ffc107; }
    .status-configured { background: #17a2b8; }
    .status-roadmap { background: #6c757d; }
    
    /* Integration Cards with AI Management Style */
    .integration-card {
        background: white;
        border-radius: 0.75rem;
        padding: 1.5rem;
        box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        border: 1px solid #e9ecef;
        transition: all 0.3s ease;
        margin-bottom: 1.5rem;
        height: auto;
    }
    
    .integration-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(27, 94, 32, 0.15);
    }
    
    .integration-header {
        display: flex;
        justify-content: space-between;
        align-items: start;
        margin-bottom: 1rem;
    }
    
    .integration-info {
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    
    .integration-icon {
        width: 48px;
        height: 48px;
        border-radius: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: white;
    }
    
    .integration-config {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 1rem;
        margin: 1rem 0;
    }
    
    .config-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 1rem;
    }
    
    .config-item {
        text-align: left;
    }
    
    .config-item small {
        color: #6c757d;
        font-size: 0.75rem;
    }
    
    .config-item .fw-bold {
        font-weight: 600;
        margin: 0;
        font-size: 0.875rem;
    }
    
    /* Section Title */
    .section-title-unified {
        font-size: 1.25rem;
        font-weight: 600;
        color: #1B5E20;
        margin: 2rem 0 1.5rem 0;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid #e9ecef;
    }
    
    /* Status Badge */
    .status-badge {
        font-size: 0.75rem;
        font-weight: 500;
        padding: 0.25rem 0.5rem;
    }
    
    /* Button Styling */
    .btn-sm {
        padding: 0.25rem 0.75rem;
        font-size: 0.75rem;
        border-radius: 0.375rem;
    }
    
    .integration-header {
        padding: 1rem 1.5rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        cursor: pointer;
        background: #f8f9fa;
        border-bottom: 1px solid #e9ecef;
    }
    
    .integration-info {
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    
    .integration-icon {
        width: 40px;
        height: 40px;
        border-radius: 0.25rem;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.25rem;
        color: white;
    }
    
    .integration-meta {
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    
    .status-badge {
        padding: 0.25rem 0.75rem;
        border-radius: 1rem;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
    }
    
    .status-active { background: #d4edda; color: #155724; }
    .status-configured { background: #fff3cd; color: #856404; }
    .status-inactive { background: #f8d7da; color: #721c24; }
    .status-roadmap { background: #d1ecf1; color: #0c5460; }
    
    .priority-badge {
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.75rem;
        font-weight: 600;
    }
    
    .priority-high { background: #dc3545; color: white; }
    .priority-medium { background: #ffc107; color: #212529; }
    .priority-low { background: #6c757d; color: white; }
    .priority-critical { background: #8b0000; color: white; }
    
    .integration-details {
        padding: 1.5rem;
        display: none;
        border-top: 1px solid #e9ecef;
    }
    
    .integration-details.expanded {
        display: block;
    }
    
    .detail-section {
        margin-bottom: 1.5rem;
    }
    
    .detail-section:last-child {
        margin-bottom: 0;
    }
    
    .detail-title {
        font-weight: 600;
        color: #495057;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    
    .config-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
    }
    
    .config-item {
        padding: 0.75rem;
        background: #f8f9fa;
        border-radius: 0.25rem;
        font-family: 'Courier New', monospace;
        font-size: 0.875rem;
        position: relative;
    }
    
    .config-item.configured {
        background: #d4edda;
        border-left: 4px solid #28a745;
    }
    
    .config-item.missing {
        background: #f8d7da;
        border-left: 4px solid #dc3545;
    }
    
    .endpoint-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    
    .endpoint-item {
        padding: 0.5rem;
        background: #f8f9fa;
        border-radius: 0.25rem;
        margin-bottom: 0.5rem;
        font-family: 'Courier New', monospace;
        font-size: 0.875rem;
        word-break: break-all;
    }
    
    .test-button {
        background: #17a2b8;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 0.25rem;
        cursor: pointer;
        font-size: 0.875rem;
        transition: all 0.3s ease;
    }
    
    .test-button:hover {
        background: #138496;
    }
    
    .test-button:disabled {
        background: #6c757d;
        cursor: not-allowed;
    }
    
    .test-result {
        margin-top: 1rem;
        padding: 1rem;
        border-radius: 0.25rem;
        font-size: 0.875rem;
    }
    
    .test-success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }
    
    .test-error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }
    
    .category-section {
        margin-bottom: 3rem;
    }
    
    .category-header {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1.5rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid #e9ecef;
    }
    
    .category-icon {
        width: 48px;
        height: 48px;
        border-radius: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: white;
    }
    
    .implementation-files {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
    }
    
    .file-tag {
        background: #e9ecef;
        color: #495057;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.75rem;
        font-family: 'Courier New', monospace;
    }
    
    .dependency-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
    }
    
    .dependency-tag {
        background: #d1ecf1;
        color: #0c5460;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.75rem;
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }
    
    .metric-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 12px;
        padding: 1.5rem;
        text-align: center;
        box-shadow: 0 4px 16px rgba(0,0,0,0.1);
    }
    
    .metric-value {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }
    
    .metric-label {
        font-size: 0.875rem;
        opacity: 0.9;
    }
    
    /* Action Button Groups */
    .btn-group-unified {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
    }
    
    .btn-group-unified .btn {
        padding: 0.5rem 1rem;
        border-radius: 0.375rem;
        font-size: 0.875rem;
        font-weight: 500;
    }
    
    .roadmap-timeline {
        position: relative;
        padding-left: 2rem;
    }
    
    .roadmap-timeline::before {
        content: '';
        position: absolute;
        left: 0.5rem;
        top: 0;
        bottom: 0;
        width: 2px;
        background: #dee2e6;
    }
    
    .roadmap-item {
        position: relative;
        margin-bottom: 2rem;
    }
    
    .roadmap-item::before {
        content: '';
        position: absolute;
        left: -1.875rem;
        top: 0.5rem;
        width: 0.75rem;
        height: 0.75rem;
        border-radius: 50%;
        background: #1B5E20;
    }
    
    .effort-indicator {
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
        font-size: 0.75rem;
        color: #6c757d;
    }
    </style>
</head>
<body>
    {% include 'components/unified_navigation.html' %}
    
    <div class="page-container">
        <div class="container-fluid-unified">
            <!-- Page Header -->
            <div class="page-header-unified">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h1 class="page-title-unified mb-3">
                                <i class="fas fa-code me-2"></i>
                                API Integrations Documentation
                            </h1>
                            <p class="page-subtitle-unified lead mb-0">Technical reference for all platform API endpoints, authentication, and testing</p>
                        </div>
                        <div class="col-md-4">
                            <div class="btn-group-unified">
                                <button class="btn btn-outline-light" onclick="refreshAllStatus()">
                                    <i class="fas fa-sync-alt me-2"></i>Refresh Status
                                </button>
                                <button class="btn btn-light" onclick="exportApiDocs()">
                                    <i class="fas fa-download me-2"></i>Export API Docs
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Statistics -->
            <div class="stats-grid" id="integration-stats">
                <div class="metric-card">
                    <div class="metric-value" id="total-integrations">-</div>
                    <div class="metric-label">إجمالي التكاملات</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="active-integrations">-</div>
                    <div class="metric-label">نشط</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="configured-integrations">-</div>
                    <div class="metric-label">مُعد</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="roadmap-integrations">-</div>
                    <div class="metric-label">خارطة الطريق</div>
                </div>
            </div>

            <!-- Filter Controls -->
            <div style="background: white; border: 1px solid #e1e8ed; border-radius: 8px; padding: 1rem; margin-bottom: 2rem;">
                <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                    <label for="statusFilter"><strong>Status:</strong></label>
                    <select id="statusFilter" style="padding: 0.5rem; border: 1px solid #e1e8ed; border-radius: 4px; background: white; min-width: 150px;">
                        <option value="all">All Integrations</option>
                        <option value="active">Active Only</option>
                        <option value="inactive">Inactive Only</option>
                        <option value="testing">Testing Phase</option>
                    </select>
                    
                    <label for="categoryFilter"><strong>Category:</strong></label>
                    <select id="categoryFilter" style="padding: 0.5rem; border: 1px solid #e1e8ed; border-radius: 4px; background: white; min-width: 150px;">
                        <option value="all">All Categories</option>
                        <option value="ai">AI Services</option>
                        <option value="communication">Communication</option>
                        <option value="storage">Storage & Database</option>
                        <option value="auth">Authentication</option>
                    </select>
                </div>
            </div>

            <!-- Section Title -->
            <div class="section-title-unified">
                <i class="fas fa-code me-2"></i>
                API Integration Endpoints
            </div>

            <!-- AI Services Section -->
            <div class="row mb-4">
                <!-- OpenAI GPT-4o API -->
                <div class="col-md-6" data-status="active" data-category="ai">
                    <div class="integration-card">
                        <div class="integration-header">
                            <div class="integration-info">
                                <div class="integration-icon" style="background: #74aa9c;">
                                    <i class="fas fa-brain"></i>
                                </div>
                                <div>
                                    <h5 class="mb-1">OpenAI GPT-4o API</h5>
                                    <small class="text-muted">Advanced AI text analysis for Arabic content</small>
                                    <span class="model-status status-active" title="Active"></span>
                                </div>
                            </div>
                            <div class="status-badge badge bg-success">Active</div>
                        </div>
                        
                        <!-- API Endpoint Information -->
                        <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; padding: 1rem; margin: 1rem 0;">
                            <div style="margin-bottom: 0.75rem;">
                                <strong style="color: #495057; font-size: 0.875rem; text-transform: uppercase;">API Endpoint</strong>
                            </div>
                            <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; padding: 0.75rem; margin-bottom: 0.5rem; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 0.875rem;">
                                <span style="display: inline-block; padding: 0.2rem 0.5rem; border-radius: 3px; font-size: 0.75rem; font-weight: 600; margin-right: 0.5rem; min-width: 45px; text-align: center; background: #e8f5e8; color: #2e7d32;">POST</span>
                                <code>https://api.openai.com/v1/chat/completions</code>
                            </div>
                            <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 0.75rem; margin-bottom: 0.75rem; border-radius: 0 4px 4px 0;">
                                <div style="font-weight: 600; color: #1565c0; margin-bottom: 0.25rem;">Bearer Token Authentication</div>
                                <small>Requires OPENAI_API_KEY in environment</small>
                            </div>
                            <div style="font-size: 0.875rem;">
                                <strong>Implementation:</strong> <code>utils/api_key_manager.py</code><br>
                                <strong>Model:</strong> gpt-4o | <strong>Max Tokens:</strong> 4,096 | <strong>Rate Limit:</strong> 10,000/min
                            </div>
                        </div>
                        
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-success" onclick="testIntegration('openai')">
                                <i class="fas fa-play me-1"></i>Test API
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" onclick="window.open('https://platform.openai.com/docs/api-reference', '_blank')">
                                <i class="fas fa-book me-1"></i>API Docs
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Claude 3.5 Sonnet API -->
                <div class="col-md-6" data-status="active" data-category="ai">
                    <div class="integration-card">
                        <div class="integration-header">
                            <div class="integration-info">
                                <div class="integration-icon" style="background: #d4a574;">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div>
                                    <h5 class="mb-1">Claude 3.5 Sonnet API</h5>
                                    <small class="text-muted">Cultural context analysis for Arabic content</small>
                                    <span class="model-status status-active" title="Active"></span>
                                </div>
                            </div>
                            <div class="status-badge badge bg-success">Active</div>
                        </div>
                        
                        <!-- API Endpoint Information -->
                        <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; padding: 1rem; margin: 1rem 0;">
                            <div style="margin-bottom: 0.75rem;">
                                <strong style="color: #495057; font-size: 0.875rem; text-transform: uppercase;">API Endpoint</strong>
                            </div>
                            <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; padding: 0.75rem; margin-bottom: 0.5rem; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 0.875rem;">
                                <span style="display: inline-block; padding: 0.2rem 0.5rem; border-radius: 3px; font-size: 0.75rem; font-weight: 600; margin-right: 0.5rem; min-width: 45px; text-align: center; background: #e8f5e8; color: #2e7d32;">POST</span>
                                <code>https://api.anthropic.com/v1/messages</code>
                            </div>
                            <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 0.75rem; margin-bottom: 0.75rem; border-radius: 0 4px 4px 0;">
                                <div style="font-weight: 600; color: #1565c0; margin-bottom: 0.25rem;">x-api-key Header Authentication</div>
                                <small>Requires ANTHROPIC_API_KEY in environment</small>
                            </div>
                            <div style="font-size: 0.875rem;">
                                <strong>Implementation:</strong> <code>utils/api_key_manager.py</code><br>
                                <strong>Model:</strong> claude-3-5-sonnet-20241022 | <strong>Max Tokens:</strong> 8,192 | <strong>Rate Limit:</strong> 1,000/min
                            </div>
                        </div>
                        
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-success" onclick="testIntegration('claude')">
                                <i class="fas fa-play me-1"></i>Test API
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" onclick="window.open('https://docs.anthropic.com/claude/reference', '_blank')">
                                <i class="fas fa-book me-1"></i>API Docs
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Communication Services Section -->
            <div class="row mb-4">
                <!-- Gmail SMTP -->
                <div class="col-md-6">
                    <div class="integration-card">
                        <div class="integration-header">
                            <div class="integration-info">
                                <div class="integration-icon" style="background: #d93025;">
                                    <i class="fas fa-envelope"></i>
                                </div>
                                <div>
                                    <h5 class="mb-1">Gmail SMTP</h5>
                                    <small class="text-muted">إرسال الاستطلاعات</small>
                                    <span class="model-status status-active" title="نشط"></span>
                                </div>
                            </div>
                            <div class="status-badge badge bg-success">نشط</div>
                        </div>
                        
                        <div class="integration-config">
                            <div class="config-grid">
                                <div class="config-item">
                                    <small>نوع التشفير</small>
                                    <p class="fw-bold">TLS</p>
                                </div>
                                <div class="config-item">
                                    <small>معدل النجاح</small>
                                    <p class="fw-bold">99.5%</p>
                                </div>
                                <div class="config-item">
                                    <small>الدعم</small>
                                    <p class="fw-bold">عربي/إنجليزي</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-success" onclick="testIntegration('gmail')">
                                <i class="fas fa-paper-plane me-1"></i>اختبار إرسال
                            </button>
                            <button class="btn btn-sm btn-outline-primary" onclick="configureIntegration('gmail')">
                                <i class="fas fa-cog me-1"></i>إعدادات
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Replit OAuth -->
                <div class="col-md-6">
                    <div class="integration-card">
                        <div class="integration-header">
                            <div class="integration-info">
                                <div class="integration-icon" style="background: #1B5E20;">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div>
                                    <h5 class="mb-1">Replit OAuth 2.0</h5>
                                    <small class="text-muted">المصادقة الآمنة</small>
                                    <span class="model-status status-active" title="نشط"></span>
                                </div>
                            </div>
                            <div class="status-badge badge bg-success">نشط</div>
                        </div>
                        
                        <div class="integration-config">
                            <div class="config-grid">
                                <div class="config-item">
                                    <small>بروتوكول الأمان</small>
                                    <p class="fw-bold">PKCE</p>
                                </div>
                                <div class="config-item">
                                    <small>مدة الجلسة</small>
                                    <p class="fw-bold">24 ساعة</p>
                                </div>
                                <div class="config-item">
                                    <small>التشفير</small>
                                    <p class="fw-bold">JWT</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-success" onclick="testIntegration('replit_oauth')">
                                <i class="fas fa-key me-1"></i>اختبار المصادقة
                            </button>
                            <button class="btn btn-sm btn-outline-primary" onclick="configureIntegration('replit_oauth')">
                                <i class="fas fa-cog me-1"></i>إعدادات
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Database & Storage Section -->
            <div class="row mb-4">
                <!-- PostgreSQL -->
                <div class="col-md-6">
                    <div class="integration-card">
                        <div class="integration-header">
                            <div class="integration-info">
                                <div class="integration-icon" style="background: #336791;">
                                    <i class="fas fa-database"></i>
                                </div>
                                <div>
                                    <h5 class="mb-1">PostgreSQL</h5>
                                    <small class="text-muted">قاعدة البيانات الرئيسية</small>
                                    <span class="model-status status-active" title="نشط"></span>
                                </div>
                            </div>
                            <div class="status-badge badge bg-success">نشط</div>
                        </div>
                        
                        <div class="integration-config">
                            <div class="config-grid">
                                <div class="config-item">
                                    <small>الإصدار</small>
                                    <p class="fw-bold">13+</p>
                                </div>
                                <div class="config-item">
                                    <small>دعم العربية</small>
                                    <p class="fw-bold">محسّن</p>
                                </div>
                                <div class="config-item">
                                    <small>تجميع الاتصالات</small>
                                    <p class="fw-bold">مفعّل</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-success" onclick="testIntegration('postgresql')">
                                <i class="fas fa-plug me-1"></i>اختبار الاتصال
                            </button>
                            <button class="btn btn-sm btn-outline-primary" onclick="configureIntegration('postgresql')">
                                <i class="fas fa-cog me-1"></i>إعدادات
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Roadmap Integrations -->
                <div class="col-md-6">
                    <div class="integration-card" style="opacity: 0.7;">
                        <div class="integration-header">
                            <div class="integration-info">
                                <div class="integration-icon" style="background: #6c757d;">
                                    <i class="fas fa-road"></i>
                                </div>
                                <div>
                                    <h5 class="mb-1">تكاملات مخططة</h5>
                                    <small class="text-muted">Salesforce, Zendesk, HubSpot</small>
                                    <span class="model-status status-roadmap" title="خارطة الطريق"></span>
                                </div>
                            </div>
                            <div class="status-badge badge bg-secondary">خارطة الطريق</div>
                        </div>
                        
                        <div class="integration-config">
                            <div class="config-grid">
                                <div class="config-item">
                                    <small>التطوير</small>
                                    <p class="fw-bold">Q3 2025</p>
                                </div>
                                <div class="config-item">
                                    <small>الأولوية</small>
                                    <p class="fw-bold">عالية</p>
                                </div>
                                <div class="config-item">
                                    <small>المدة المتوقعة</small>
                                    <p class="fw-bold">2-3 أسابيع</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-secondary" disabled>
                                <i class="fas fa-clock me-1"></i>قيد التطوير
                            </button>
                        </div>
                    </div>
                </div>
            </div>

        <!-- Developer APIs Category -->
        <div class="category-section" data-category="Developer APIs">
            <div class="category-header">
                <div class="category-icon" style="background: #6f42c1;">
                    <i class="fas fa-code"></i>
                </div>
                <div>
                    <h3 class="mb-0">واجهات المطورين</h3>
                    <p class="text-muted mb-0">APIs و Webhooks والتكاملات المخصصة</p>
                </div>
            </div>
            <div id="developer-integrations"></div>
        </div>
    </div>

    <script>
    let integrationsData = {};
    let currentFilter = 'all';

    // Load integration data on page load
    document.addEventListener('DOMContentLoaded', function() {
        loadIntegrationsData();
        initNotifications();
        
        // Add event listeners for filters
        document.getElementById('statusFilter').addEventListener('change', filterIntegrations);
        document.getElementById('categoryFilter').addEventListener('change', filterIntegrations);
    });

    async function loadIntegrationsData() {
        try {
            const response = await fetch('/api/integrations/status');
            const data = await response.json();
            
            if (data.success) {
                updateStatistics(data.summary);
            } else {
                console.error('Error loading integrations:', data.error);
            }
        } catch (error) {
            console.error('Error fetching integrations:', error);
        }
    }

    function updateStatistics(summary) {
        document.getElementById('total-integrations').textContent = summary.total_integrations || 5;
        document.getElementById('active-integrations').textContent = summary.active || 5;
        document.getElementById('configured-integrations').textContent = summary.configured || 0;
        document.getElementById('roadmap-integrations').textContent = summary.roadmap || 6;
    }
    
    function initNotifications() {
        // Initialize notification system
        if (!document.getElementById('notification-container')) {
            const container = document.createElement('div');
            container.id = 'notification-container';
            container.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 1050;
                max-width: 300px;
            `;
            document.body.appendChild(container);
        }
    }

    function showNotification(message, type = 'info') {
        const container = document.getElementById('notification-container');
        const notification = document.createElement('div');
        notification.className = `alert alert-${type === 'error' ? 'danger' : type} alert-dismissible fade show`;
        notification.innerHTML = `
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        container.appendChild(notification);
        
        // Auto remove after 5 seconds
        setTimeout(() => {
            notification.remove();
        }, 5000);
    }

    // Simplified functions for the unified design

    async function testIntegration(integrationId) {
        const button = event.target;
        const originalText = button.innerHTML;
        button.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>جاري الاختبار...';
        button.disabled = true;
        
        try {
            const response = await fetch(`/api/integrations/test/${integrationId}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            });
            
            const data = await response.json();
            
            if (data.success && data.test_result?.success) {
                showNotification(`نجح اختبار ${integrationId}! ${data.test_result.response_time_ms ? `(${data.test_result.response_time_ms}ms)` : ''}`, 'success');
                updateIntegrationStatus(integrationId, 'active');
            } else {
                showNotification(`فشل اختبار ${integrationId}: ${data.test_result?.error || data.error || 'خطأ غير معروف'}`, 'error');
                updateIntegrationStatus(integrationId, 'inactive');
            }
        } catch (error) {
            showNotification(`خطأ في الاتصال مع ${integrationId}: ${error.message}`, 'error');
        } finally {
            button.innerHTML = originalText;
            button.disabled = false;
        }
    }

    async function refreshAllStatus() {
        const button = event.target;
        const originalText = button.innerHTML;
        button.disabled = true;
        button.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>جاري التحديث...';
        
        await loadIntegrationsData();
        showNotification('تم تحديث حالة جميع التكاملات', 'success');
        
        button.disabled = false;
        button.innerHTML = originalText;
    }
    
    function configureIntegration(integrationId) {
        showNotification(`فتح إعدادات ${integrationId}...`, 'info');
        // Could redirect to settings page or open modal
        window.location.href = `/settings#${integrationId}`;
    }
    
    function updateIntegrationStatus(integrationId, status) {
        // Update visual status indicator
        const statusElement = document.querySelector(`[data-integration="${integrationId}"] .model-status`);
        if (statusElement) {
            statusElement.className = `model-status status-${status}`;
        }
    }
    
    function testAllConnections() {
        const integrations = ['openai', 'claude', 'gmail', 'replit_oauth', 'postgresql'];
        showNotification('Testing all connections...', 'info');
        
        integrations.forEach((integration, index) => {
            setTimeout(() => {
                // Simulate clicking test button for each integration
                const button = document.querySelector(`[onclick="testIntegration('${integration}')"]`);
                if (button) {
                    button.click();
                }
            }, index * 1000); // Stagger tests by 1 second each
        });
    }

    // Filter Functions
    function filterIntegrations() {
        const statusFilter = document.getElementById('statusFilter').value;
        const categoryFilter = document.getElementById('categoryFilter').value;
        const cards = document.querySelectorAll('.col-md-6[data-status]');
        
        cards.forEach(card => {
            const status = card.getAttribute('data-status');
            const category = card.getAttribute('data-category');
            
            const statusMatch = statusFilter === 'all' || status === statusFilter;
            const categoryMatch = categoryFilter === 'all' || category === categoryFilter;
            
            if (statusMatch && categoryMatch) {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        });
    }

    // Export API Documentation
    function exportApiDocs() {
        const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
        const filename = `api-integrations-catalog-${timestamp}.json`;
        
        const apiData = {
            generated: new Date().toISOString(),
            platform: 'Voice of Customer Platform',
            integrations: []
        };
        
        document.querySelectorAll('.integration-card').forEach(card => {
            const name = card.querySelector('h5').textContent;
            const description = card.querySelector('.text-muted').textContent;
            const status = card.closest('[data-status]')?.getAttribute('data-status') || 'unknown';
            const category = card.closest('[data-category]')?.getAttribute('data-category') || 'unknown';
            const endpoints = [];
            
            card.querySelectorAll('code').forEach(endpoint => {
                if (endpoint.textContent.includes('http')) {
                    endpoints.push(endpoint.textContent);
                }
            });
            
            apiData.integrations.push({
                name,
                description,
                status,
                category,
                endpoints
            });
        });
        
        const blob = new Blob([JSON.stringify(apiData, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        a.click();
        URL.revokeObjectURL(url);
        
        showNotification('API documentation exported successfully', 'success');
    }
    </script>
    
    {% include 'components/scripts.html' %}
</body>
</html>