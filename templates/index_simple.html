<!DOCTYPE html>
<html lang="{{ get_lang() }}" dir="{{ get_dir() }}">
<head>
    {% include 'components/head.html' %}
    <title>Voice of Customer Platform</title>
    
    <style>
        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
        }

        /* Hero Section - Simple and vibrant */
        .hero-section {
            background: linear-gradient(135deg, #2E8B57 0%, #3A9B6A 50%, #45A574 100%);
            color: white;
            padding: 4rem 2rem;
            margin: 2rem 0;
            border-radius: 1.5rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(46, 139, 87, 0.3);
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.1) 0%, transparent 50%);
            z-index: 1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
        }

        .hero-title {
            font-family: 'Amiri', serif;
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: white;
            line-height: 1.2;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .hero-description {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            line-height: 1.6;
            opacity: 0.95;
            max-width: 700px;
            margin-right: auto;
            margin-left: auto;
        }

        .cta-button {
            background: #ffffff;
            color: #2E8B57;
            border: none;
            padding: 1.2rem 3rem;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.3);
            text-decoration: none;
            display: inline-block;
            margin: 0.5rem;
        }

        .cta-button:hover {
            background: #f8f9fa;
            color: #236B47;
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(255, 255, 255, 0.4);
        }

        /* Simple Footer */
        .simple-footer {
            background: #2c3e50;
            color: white;
            padding: 2rem 0;
            margin-top: 3rem;
            text-align: center;
        }

        .footer-brand {
            font-family: 'Amiri', serif;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .footer-links {
            margin: 1rem 0;
        }

        .footer-links a {
            color: #bdc3c7;
            text-decoration: none;
            margin: 0 1rem;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: white;
        }

        .footer-copyright {
            margin-top: 1rem;
            color: #95a5a6;
            font-size: 0.9rem;
        }

        /* Features Highlight - Clean minimal */
        .features-highlight {
            background: white;
            padding: 3rem 2rem;
            border-radius: 16px;
            margin: 4rem auto;
            max-width: 700px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.04);
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .feature-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 1rem;
            padding: 1.5rem 1rem;
            background: #f8fafc;
            border-radius: 12px;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }
        
        .feature-item:hover {
            transform: translateY(-4px);
            background: white;
            border-color: rgba(46, 139, 87, 0.1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        }
        
        .feature-icon {
            font-size: 2rem;
            color: #2E8B57;
            opacity: 0.8;
        }
        
        /* Add subtle animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .hero-content > * {
            animation: fadeInUp 0.8s ease-out;
        }
        
        .hero-title { animation-delay: 0.1s; }
        .hero-description { animation-delay: 0.2s; }
        .features-highlight { animation-delay: 0.3s; }
        .cta-button { animation-delay: 0.4s; }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-description {
                font-size: 1.2rem;
                padding: 0 1rem;
            }
            
            .cta-button {
                display: block;
                margin: 1rem auto;
                max-width: 280px;
            }

            .footer-links a {
                display: block;
                margin: 0.5rem 0;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .features-highlight {
                margin: 1.5rem 1rem;
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    {% include 'components/unified_navigation.html' %}

    <div class="container">
        <!-- Hero Section -->
        <section class="hero-section">
            <div class="hero-content">
                <h1 class="hero-title">
                    {{ 'homepage.hero.title' | translate }}
                </h1>
                <!-- Demo Notice Badge -->
                <div style="background: rgba(255,255,255,0.2); padding: 0.4rem 1.2rem; border-radius: 20px; display: inline-block; margin-bottom: 1rem; border: 1px solid rgba(255,255,255,0.3);">
                    <i class="fas fa-flask me-2"></i>
                    <strong>{{ 'homepage.demo.title' | translate }}</strong> - {{ 'homepage.demo.subtitle' | translate }}
                </div>
                
                <p class="hero-description">
                    {{ 'homepage.hero.description' | translate }}
                </p>
                
                <!-- Simple Call to Action -->
                <div>
                    {% if current_user.is_authenticated %}
                        <!-- Authenticated user actions -->
                        <a href="/surveys/create" class="cta-button" style="background: #28a745; color: white; box-shadow: 0 8px 25px rgba(40, 167, 69, 0.3);">
                            <i class="fas fa-plus me-2"></i>
                            {{ 'buttons.create_survey' | translate }}
                        </a>
                        <a href="/analytics/dashboard" class="cta-button" style="background: #007bff; color: white; box-shadow: 0 8px 25px rgba(0, 123, 255, 0.3);">
                            <i class="fas fa-chart-line me-2"></i>
                            {{ 'buttons.view_analytics' | translate }}
                        </a>
                        <br>
                        <a href="/surveys" class="cta-button">
                            <i class="fas fa-tasks me-2"></i>
                            {{ 'buttons.manage_surveys' | translate }}
                        </a>
                        <a href="/analytics/insights" class="cta-button">
                            <i class="fas fa-lightbulb me-2"></i>
                            {{ 'buttons.ai_insights' | translate }}
                        </a>
                    {% else %}
                        <!-- Guest user actions -->
                        <a href="/auth/replit_auth" class="cta-button" style="background: #007bff; color: white; box-shadow: 0 8px 25px rgba(0, 123, 255, 0.3);">
                            <i class="fas fa-sign-in-alt me-2"></i>
                            {{ 'buttons.login' | translate }}
                        </a>
                        <br>
                        <a href="/surveys/create" class="cta-button">
                            <i class="fas fa-plus me-2"></i>
                            {{ 'buttons.start_exploring' | translate }}
                        </a>
                        <a href="/analytics/demo" class="cta-button">
                            <i class="fas fa-play me-2"></i>
                            {{ 'buttons.try_demo' | translate }}
                        </a>
                    {% endif %}
                </div>
            </div>
        </section>
    </div>

    <!-- Simple Footer -->
    <footer class="simple-footer">
        <div class="container">
            <div class="footer-brand">{{ 'app.name' | translate }}</div>
            
            <!-- Demo Notice -->
            <div style="background: rgba(255,193,7,0.2); padding: 1rem; border-radius: 0.5rem; margin: 1rem 0; border: 1px solid rgba(255,193,7,0.4);">
                <i class="fas fa-info-circle me-2" style="color: #ffc107;"></i>
                <strong>{{ 'homepage.demo.footer_notice' | translate }}</strong> {{ 'homepage.demo.footer_subtitle' | translate }}
            </div>
            
            <!-- Essential Links Only -->
            <div class="footer-links">
                <a href="/surveys/builder">{{ 'buttons.create_survey' | translate }}</a>
                <a href="/surveys">{{ 'navigation.surveys_dropdown.title' | translate }}</a>
                <a href="/dashboard/realtime">{{ 'buttons.dashboard' | translate }}</a>
            </div>
            
            <div class="footer-copyright">
                Voice of Customer Platform. Licensed under MIT License © 2025
            </div>
        </div>
    </footer>

    {% include 'components/scripts.html' %}
    
    <!-- Persistent Footer Feedback Form -->
    <style>
    .persistent-footer-feedback {
        background: #f8f9fa;
        border-top: 1px solid #e9ecef;
        margin-top: 3rem;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }

    .feedback-header {
        background: #1e3a8a;
        color: white;
        padding: 16px 0;
        text-align: center;
    }

    .feedback-header h3 {
        margin: 0;
        font-weight: 600;
        font-size: 18px;
    }

    .feedback-body {
        padding: 24px 0;
        max-width: 800px;
        margin: 0 auto;
        direction: rtl;
        text-align: right;
    }

    .feedback-question {
        margin-bottom: 20px;
    }

    .feedback-question label {
        display: block;
        font-weight: 600;
        font-size: 16px;
        color: #2d3748;
        margin-bottom: 12px;
    }

    .radio-group {
        display: flex;
        gap: 20px;
        margin-bottom: 20px;
        justify-content: flex-end;
    }

    .radio-option {
        display: flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
    }

    .radio-option input[type="radio"] {
        width: 18px;
        height: 18px;
        margin: 0;
    }

    .radio-option label {
        margin: 0;
        font-weight: 500;
        font-size: 15px;
        cursor: pointer;
    }

    .conditional-section {
        display: none;
        animation: slideDown 0.3s ease-out;
        border-top: 1px solid #e2e8f0;
        padding-top: 20px;
        margin-top: 20px;
    }

    .conditional-section.show {
        display: block;
    }

    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .category-options {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-bottom: 20px;
    }

    .category-option {
        display: flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
    }

    .category-option input[type="radio"] {
        width: 16px;
        height: 16px;
        margin: 0;
    }

    .category-option label {
        margin: 0;
        font-weight: 400;
        font-size: 14px;
        cursor: pointer;
        color: #4a5568;
    }

    .feedback-textarea {
        width: 100%;
        min-height: 120px;
        padding: 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-family: inherit;
        font-size: 14px;
        resize: vertical;
        direction: rtl;
    }

    .feedback-textarea:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .feedback-submit {
        background: #3b82f6;
        color: white;
        border: none;
        padding: 12px 32px;
        border-radius: 6px;
        font-weight: 600;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.2s;
        margin-top: 16px;
    }

    .feedback-submit:hover {
        background: #2563eb;
        transform: translateY(-1px);
    }

    .feedback-submit:disabled {
        background: #9ca3af;
        cursor: not-allowed;
        transform: none;
    }

    .privacy-notice {
        font-size: 12px;
        color: #6b7280;
        margin-top: 12px;
        line-height: 1.4;
    }

    .privacy-notice a {
        color: #3b82f6;
        text-decoration: none;
    }

    .privacy-notice a:hover {
        text-decoration: underline;
    }

    .success-message {
        display: none;
        background: #d1fae5;
        border: 1px solid #10b981;
        color: #065f46;
        padding: 16px;
        border-radius: 6px;
        text-align: center;
        font-weight: 500;
    }

    .success-message.show {
        display: block;
    }

    @media (max-width: 768px) {
        .feedback-body {
            padding: 20px 16px;
        }
        
        .radio-group {
            flex-direction: column;
            gap: 12px;
        }
        
        .category-options {
            gap: 8px;
        }
    }
    </style>

    <div class="persistent-footer-feedback">
        <div class="feedback-header">
            <h3>هل وجدت ما تبحث عنه اليوم؟</h3>
        </div>
        <div class="feedback-body">
            <form id="footerFeedbackForm">
                <div class="feedback-question">
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="helpful-yes" name="helpful" value="yes" onchange="handleHelpfulResponse('yes')">
                            <label for="helpful-yes">نعم</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="helpful-no" name="helpful" value="no" onchange="handleHelpfulResponse('no')">
                            <label for="helpful-no">لا</label>
                        </div>
                    </div>
                </div>

                <div id="feedbackSection" class="conditional-section">
                    <div class="feedback-question">
                        <label>نحن نقدر ملاحظاتك</label>
                        <p style="font-size: 14px; color: #6b7280; margin-bottom: 16px;">ما الذي ترغب في مشاركته حول تجربتك؟</p>
                        
                        <div class="category-options" id="categoryOptions">
                            <!-- Categories will be populated by JavaScript -->
                        </div>
                    </div>

                    <div class="feedback-question">
                        <label for="feedbackText">أخبرنا المزيد عن تجربتك:</label>
                        <textarea 
                            id="feedbackText" 
                            name="feedbackText" 
                            class="feedback-textarea" 
                            placeholder="يرجى عدم تضمين معلومات شخصية في رسالتك. سيتم حذف أي معلومات شخصية مقدمة."
                        ></textarea>
                    </div>

                    <button type="submit" class="feedback-submit">إرسال الملاحظات</button>
                    
                    <div class="privacy-notice">
                        يرجى عدم تضمين معلومات شخصية في رسالتك. أي معلومات شخصية مقدمة سيتم حذفها. 
                        إذا كان لديك أسئلة حول خدمات المنصة، يرجى <a href="/contact">التواصل معنا</a>.
                    </div>
                </div>

                <div id="successMessage" class="success-message">
                    شكراً لك! تم إرسال ملاحظاتك بنجاح. نقدر وقتك ومساهمتك في تحسين المنصة.
                </div>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set active navigation
            if (typeof StandardNavigation !== 'undefined') {
                StandardNavigation.setActiveNav('home');
            }
        });

        // Persistent Footer Feedback Form Functionality
        (function() {
            const categoryOptionsConfig = {
                yes: [
                    { value: 'suggestion', text: 'لدي اقتراح أو فكرة' },
                    { value: 'compliment', text: 'أريد مشاركة تعليق إيجابي' },
                    { value: 'feature-request', text: 'أطلب ميزة جديدة' }
                ],
                no: [
                    { value: 'confusing', text: 'شيء ما محير' },
                    { value: 'broken', text: 'شيء ما لا يعمل' },
                    { value: 'missing-info', text: 'معلومات مفقودة' }
                ]
            };

            window.handleHelpfulResponse = function(response) {
                const feedbackSection = document.getElementById('feedbackSection');
                const categoryOptions = document.getElementById('categoryOptions');
                
                // Show the feedback section
                feedbackSection.classList.add('show');
                
                // Clear existing categories
                categoryOptions.innerHTML = '';
                
                // Add appropriate categories based on response
                const categories = categoryOptionsConfig[response] || [];
                categories.forEach((category, index) => {
                    const categoryHtml = `
                        <div class="category-option">
                            <input type="radio" id="category-${category.value}" name="category" value="${category.value}">
                            <label for="category-${category.value}">${category.text}</label>
                        </div>
                    `;
                    categoryOptions.innerHTML += categoryHtml;
                });
                
                // Scroll to the feedback section smoothly
                feedbackSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            };

            // Handle form submission
            document.getElementById('footerFeedbackForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const feedbackData = {
                    helpful: formData.get('helpful'),
                    category: formData.get('category'),
                    text: formData.get('feedbackText'),
                    source: 'homepage_footer',
                    timestamp: new Date().toISOString()
                };
                
                // Disable submit button
                const submitBtn = this.querySelector('.feedback-submit');
                const originalText = submitBtn.textContent;
                submitBtn.disabled = true;
                submitBtn.textContent = 'جاري الإرسال...';
                
                try {
                    // Submit feedback to backend
                    const response = await fetch('/api/feedback/widget', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            rating: feedbackData.helpful === 'yes' ? 5 : 2,
                            comment: `${feedbackData.category ? '[' + feedbackData.category + '] ' : ''}${feedbackData.text || ''}`,
                            channel: 'FOOTER_WIDGET',
                            source: feedbackData.source,
                            metadata: {
                                helpful: feedbackData.helpful,
                                category: feedbackData.category,
                                timestamp: feedbackData.timestamp
                            }
                        })
                    });
                    
                    if (response.ok) {
                        // Show success message
                        document.getElementById('feedbackSection').style.display = 'none';
                        document.getElementById('successMessage').classList.add('show');
                        
                        // Track success
                        if (typeof gtag !== 'undefined') {
                            gtag('event', 'footer_feedback_submitted', {
                                'helpful': feedbackData.helpful,
                                'category': feedbackData.category,
                                'source': 'homepage_footer'
                            });
                        }
                        
                        console.log('Footer feedback submitted successfully');
                    } else {
                        throw new Error('Network response was not ok');
                    }
                } catch (error) {
                    console.error('Error submitting feedback:', error);
                    alert('حدث خطأ أثناء إرسال الملاحظات. يرجى المحاولة مرة أخرى.');
                    
                    // Re-enable submit button
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalText;
                }
            });
        })();
    </script>
</body>
</html>